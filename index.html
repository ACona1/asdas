<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ðŸŽ¬ Ù…Ø´ØºÙ„ Ø§Ù„Ø­Ù„Ù‚Ø§Øª</title>
  <style>
    body { background:#111; color:#eee; font-family:Arial; text-align:center; padding:20px; }
    .category { margin:20px 0; padding:10px; background:#222; border-radius:8px; }
    .episode { cursor:pointer; margin:5px; padding:8px; background:#333; border-radius:6px; }
    .episode:hover { background:#555; }
    video { width: 100%; max-width: 640px; height: auto; border-radius:8px; }
  </style>
</head>
<body>

  <h2>ðŸ“º Ù…Ø´ØºÙ„ Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ù…Ø¹ Ø§Ù„ØªØ±Ø¬Ù…Ø©</h2>
  <video id="player" controls preload="auto">
    <track id="subtitle" kind="subtitles" srclang="ar" label="Arabic" default>
  </video>

  <div id="playlist"></div>

<script>
  const player = document.getElementById("player");
  const subtitleTrack = document.getElementById("subtitle");

  async function loadVideo(videoUrl, subUrl) {
    player.src = videoUrl;

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø©
    const res = await fetch(subUrl);
    let txt = await res.text();
    if (!txt.startsWith("WEBVTT")) txt = "WEBVTT\n\n" + txt;

    const blob = new Blob([txt], { type: "text/vtt" });
    const trackUrl = URL.createObjectURL(blob);
    subtitleTrack.src = trackUrl;

    player.load();
    player.play();
  }

  async function loadPlaylist() {
    const res = await fetch("https://gist.githubusercontent.com/ACona1/c670df837e4ed498d15295d4b650dfd0/raw/playlist.txt");
    const categories = await res.json();

    const playlistDiv = document.getElementById("playlist");
    playlistDiv.innerHTML = "";

    for (const [catName, episodes] of Object.entries(categories)) {
      const catDiv = document.createElement("div");
      catDiv.className = "category";
      catDiv.innerHTML = `<h3>${catName}</h3>`;

      episodes.forEach((ep, i) => {
        const epDiv = document.createElement("div");
        epDiv.className = "episode";
        epDiv.textContent = `Ø­Ù„Ù‚Ø© ${i+1}`;
        epDiv.onclick = () => loadVideo(ep.video, ep.sub);
        catDiv.appendChild(epDiv);
      });

      playlistDiv.appendChild(catDiv);
    }
  }

  loadPlaylist();
</script>

</body>
</html>
